
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>음력 1월 1일 설날: 네가 하루라면 어떻게 할거야?</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: "Arial", sans-serif;
      padding: 30px;
      background-color: #f4f4f4;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }
    textarea {
      width: 100%;
      height: 80px;
      font-size: 1em;
      padding: 10px;
      resize: none;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
    }
    .response {
      background: #fff;
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 10px;
      border-radius: 5px;
      position: relative;
    }
    .delete-btn {
      position: absolute;
      right: 10px;
      top: 10px;
      background: #ff4d4d;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 0.9em;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <h1>음력 1월 1일 설날: 네가 하루라면 어떻게 할거야?</h1>
  <textarea id="answerInput" placeholder="여기에 너의 생각을 적어줘!"></textarea><br/>
  <button onclick="submitAnswer()">생각나누기</button>

  <div id="responses"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAqoHgT_SyybUTDUrPgOy7DH-xwLQpLLGU",
      authDomain: "haru-dc490.firebaseapp.com",
      databaseURL: "https://haru-dc490-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "haru-dc490",
      storageBucket: "haru-dc490.firebasestorage.app",
      messagingSenderId: "1062975092523",
      appId: "1:1062975092523:web:d0184c83335c539467b76e",
      measurementId: "G-EGGCFLJ1JY"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const isAdmin = window.location.search.includes("admin=true");

    function submitAnswer() {
      const text = document.getElementById("answerInput").value.trim();
      if (!text) {
        alert("여기에 너의 생각을 적어줘!");
        return;
      }
      const timestamp = Date.now();
      db.ref("responses/" + timestamp).set({ text });
      document.getElementById("answerInput").value = "";
    }

    function deleteAnswer(key) {
      if (confirm("정말 이 답변을 삭제하시겠습니까?")) {
        db.ref("responses/" + key).remove();
      }
    }

    function loadAnswers() {
      const container = document.getElementById("responses");
      db.ref("responses").on("value", (snapshot) => {
        container.innerHTML = "";
        const data = snapshot.val();
        if (data) {
          const keys = Object.keys(data).sort((a, b) => b - a);
          keys.forEach(key => {
            const entry = document.createElement("div");
            entry.className = "response";
            entry.textContent = data[key].text;

            if (isAdmin) {
              const delBtn = document.createElement("button");
              delBtn.className = "delete-btn";
              delBtn.textContent = "삭제";
              delBtn.onclick = () => deleteAnswer(key);
              entry.appendChild(delBtn);
            }

            container.appendChild(entry);
          });
        }
      });
    }

    loadAnswers();
  </script>
</body>
</html>
